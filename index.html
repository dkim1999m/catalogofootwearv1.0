<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>TOR HUB PGR | CatÃ¡logo Calzado V3</title>
  <meta name="description" content="CatÃ¡logo virtual estilo e-commerce (Caterpillar + Columbia). WhatsApp con talla opcional + QR Yape." />
  <style>
    :root{
      --bg:#0b0f0d;
      --panel:#0f1713;
      --panel2:#0d1411;
      --card:#101a15;
      --line:rgba(255,255,255,.08);
      --line2:rgba(255,255,255,.12);
      --text:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.66);
      --muted2:rgba(255,255,255,.55);
      --accent:#22c55e;
      --accent2:#f59e0b;
      --shadow: 0 14px 50px rgba(0,0,0,.45);
      --shadow2: 0 10px 40px rgba(0,0,0,.35);
      --radius:18px;
      --radius2:22px;
      --max:1180px;
    }

    *{box-sizing:border-box}
    html,body{margin:0;padding:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif;
      background:radial-gradient(1200px 600px at 18% 0%, rgba(34,197,94,.16), transparent 60%),
                 radial-gradient(900px 600px at 90% 10%, rgba(245,158,11,.14), transparent 55%),
                 var(--bg);
      color:var(--text)
    }
    a{color:inherit;text-decoration:none}
    button{font-family:inherit}

    .container{max-width:var(--max);margin:0 auto;padding:0 18px}

    /* Top notice bar */
    .notice{background:rgba(17,26,21,.78);border-bottom:1px solid var(--line);backdrop-filter: blur(10px)}
    .notice__inner{display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap;padding:8px 0}
    .notice__item{display:flex;align-items:center;gap:8px;color:var(--muted);font-size:12px;font-weight:800;letter-spacing:.2px}
    .dot{width:8px;height:8px;border-radius:99px;background:rgba(34,197,94,.9)}

    /* Header */
    .header{position:sticky;top:0;z-index:30;background:rgba(10,14,12,.76);backdrop-filter: blur(12px);border-bottom:1px solid var(--line)}
    .header__row{display:flex;align-items:center;justify-content:space-between;gap:14px;flex-wrap:wrap;padding:12px 0}

    .brand{display:flex;align-items:center;gap:12px}
    .brand__logo{width:44px;height:44px;border-radius:14px;display:grid;place-items:center;
      background:linear-gradient(135deg, rgba(34,197,94,.9), rgba(245,158,11,.75));
      color:#08110c;font-weight:950;letter-spacing:.7px;box-shadow:0 10px 30px rgba(34,197,94,.18);
    }
    .brand__name{font-weight:950;letter-spacing:.3px}
    .brand__sub{font-size:12px;color:var(--muted)}

    .search{flex:1;min-width:240px;max-width:560px;position:relative}
    .search input{width:100%;padding:12px 44px 12px 14px;border-radius:999px;border:1px solid var(--line);
      background:rgba(0,0,0,.26);color:var(--text);outline:none;font-weight:850}
    .search .icon{position:absolute;right:10px;top:50%;transform:translateY(-50%);opacity:.75}

    .icons{display:flex;align-items:center;gap:10px}
    .icoBtn{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:10px 12px;border-radius:999px;
      border:1px solid var(--line);background:rgba(255,255,255,.03);color:var(--text);font-weight:900;cursor:pointer}
    .icoBtn:hover{border-color:rgba(255,255,255,.18)}
    .ico{width:18px;height:18px;display:inline-block}

    /* Nav menu */
    .nav{border-top:1px solid var(--line);background:rgba(255,255,255,.02)}
    .nav__inner{display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap;padding:10px 0}
    .navlinks{display:flex;align-items:center;gap:18px;flex-wrap:wrap}
    .navlinks a{font-weight:950;letter-spacing:.5px;font-size:13px;color:rgba(255,255,255,.82)}
    .navlinks a.active{color:rgba(245,158,11,.95)}
    .navlinks a:hover{color:rgba(255,255,255,.95)}

    .pill{padding:10px 12px;border-radius:999px;border:1px solid var(--line);color:var(--text);font-weight:900;font-size:13px;background:rgba(255,255,255,.03)}

    /* Hero slider */
    .hero{padding:18px 0 10px}
    .heroCard{border:1px solid var(--line);border-radius:var(--radius2);overflow:hidden;box-shadow:var(--shadow)}
    .slide{position:relative;min-height:300px;display:none}
    .slide.is-active{display:block}
    .slide__bg{position:absolute;inset:0;background:
      radial-gradient(900px 500px at 10% 10%, rgba(34,197,94,.20), transparent 58%),
      radial-gradient(900px 520px at 90% 20%, rgba(245,158,11,.22), transparent 55%),
      linear-gradient(180deg, rgba(0,0,0,.18), rgba(0,0,0,.58));
    }
    .slide__content{position:relative;display:grid;grid-template-columns:1.2fr .8fr;gap:18px;align-items:center;
      padding:26px 18px}
    @media (max-width:900px){.slide__content{grid-template-columns:1fr;min-height:320px}}
    .kicker{display:inline-flex;gap:10px;align-items:center;font-weight:950;letter-spacing:.6px;color:rgba(245,158,11,.95);}
    .kicker .badge{border:1px solid rgba(245,158,11,.35);background:rgba(245,158,11,.12);padding:6px 10px;border-radius:999px;font-size:12px}
    .heroTitle{margin:10px 0 8px;font-size:40px;line-height:1.05;font-weight:980}
    @media (max-width:520px){.heroTitle{font-size:32px}}
    .muted{color:var(--muted)}
    .ctaRow{display:flex;gap:10px;flex-wrap:wrap;margin-top:14px}
    .btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:12px 14px;border-radius:14px;
      border:1px solid var(--line);background:rgba(255,255,255,.03);color:var(--text);font-weight:950;cursor:pointer}
    .btn--primary{background:linear-gradient(135deg, rgba(34,197,94,.95), rgba(34,197,94,.68));border-color:transparent;color:#07100b}
    .btn--warn{background:linear-gradient(135deg, rgba(245,158,11,.95), rgba(245,158,11,.62));border-color:transparent;color:#140b00}
    .btn:hover{border-color:rgba(255,255,255,.18)}

    .heroArt{border:1px solid rgba(255,255,255,.14);background:rgba(0,0,0,.18);border-radius:20px;padding:12px;display:grid;place-items:center}
    .heroArt svg{width:100%;height:220px}

    .sliderDots{display:flex;gap:8px;justify-content:center;padding:10px;background:rgba(0,0,0,.18);border-top:1px solid var(--line)}
    .dotBtn{width:10px;height:10px;border-radius:99px;border:1px solid rgba(255,255,255,.25);background:rgba(255,255,255,.10);cursor:pointer}
    .dotBtn.is-active{background:rgba(245,158,11,.75);border-color:rgba(245,158,11,.35)}

    /* Layout catalog */
    .catalog{padding:12px 0 26px}
    .catalogHead{display:flex;align-items:flex-end;justify-content:space-between;gap:16px;flex-wrap:wrap;margin-top:10px}
    .catalogHead h2{margin:0;font-size:26px;font-weight:980}
    .headRight{display:flex;align-items:center;gap:10px;flex-wrap:wrap}

    select{padding:11px 12px;border-radius:14px;border:1px solid var(--line);background:rgba(0,0,0,.22);color:var(--text);outline:none;font-weight:950}

    .layout{display:grid;grid-template-columns:290px 1fr;gap:14px;margin-top:14px}
    @media (max-width:980px){.layout{grid-template-columns:1fr}}

    /* Filters panel */
    .filters{border:1px solid var(--line);border-radius:var(--radius);background:rgba(255,255,255,.03);padding:12px;position:sticky;top:118px;align-self:start}
    @media (max-width:980px){.filters{display:none}}
    .filters h3{margin:0 0 10px;font-size:16px;font-weight:980}
    .fgroup{margin-top:10px}
    .fgroup label{display:block;font-size:12px;color:var(--muted);font-weight:900;margin-bottom:8px}
    .chips{display:flex;gap:8px;flex-wrap:wrap}
    .chip{border:1px solid var(--line);background:rgba(0,0,0,.18);color:var(--text);font-weight:950;font-size:12px;padding:9px 11px;border-radius:999px;cursor:pointer}
    .chip.is-active{border-color:rgba(34,197,94,.45);background:rgba(34,197,94,.14)}

    .rangeRow{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    .rangeRow input{width:100%;padding:11px 12px;border-radius:14px;border:1px solid var(--line);background:rgba(0,0,0,.25);color:var(--text);outline:none;font-weight:900}

    .check{display:flex;align-items:center;gap:10px;margin-top:10px}
    .check input{width:18px;height:18px}
    .check span{font-weight:900;color:rgba(255,255,255,.84);font-size:13px}

    .filters .btn{width:100%;margin-top:12px}

    /* Mobile filter drawer */
    .drawer{position:fixed;inset:0;z-index:80;display:none}
    .drawer.is-open{display:block}
    .drawer__overlay{position:absolute;inset:0;background:rgba(0,0,0,.66)}
    .drawer__panel{position:absolute;right:0;top:0;height:100%;width:min(420px, 92vw);
      background:linear-gradient(180deg, rgba(16,26,21,.98), rgba(8,12,10,.98));
      border-left:1px solid var(--line);box-shadow:var(--shadow);padding:14px;overflow:auto}
    .drawer__top{display:flex;align-items:center;justify-content:space-between;gap:12px}
    .drawer__top h3{margin:0;font-size:16px;font-weight:980}

    /* Grid */
    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
    @media (max-width:1100px){.grid{grid-template-columns:repeat(2,1fr)}}
    @media (max-width:520px){.grid{grid-template-columns:1fr}}

    .card{border:1px solid var(--line);border-radius:var(--radius);background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      overflow:hidden;box-shadow:0 12px 40px rgba(0,0,0,.25);cursor:pointer}
    .card:hover{border-color:rgba(255,255,255,.18)}
    .card__img{height:190px;display:grid;place-items:center;
      background:radial-gradient(320px 220px at 30% 20%, rgba(34,197,94,.18), transparent 62%),
                 radial-gradient(260px 220px at 85% 10%, rgba(245,158,11,.18), transparent 58%),
                 rgba(0,0,0,.22);
      border-bottom:1px solid var(--line)}
    .card__img svg{width:92%;height:92%}
    .card__body{padding:12px}

    .badges{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:8px}
    .badge2{font-size:11px;font-weight:980;letter-spacing:.4px;padding:6px 8px;border-radius:999px;border:1px solid var(--line);
      background:rgba(255,255,255,.03);color:var(--muted)}
    .badge2--new{border-color:rgba(34,197,94,.35);background:rgba(34,197,94,.12);color:rgba(255,255,255,.9)}
    .badge2--sale{border-color:rgba(245,158,11,.35);background:rgba(245,158,11,.12);color:rgba(255,255,255,.9)}

    .title{margin:0;font-size:15px;font-weight:980;line-height:1.2}
    .meta{margin-top:6px;color:var(--muted);font-size:12px;display:flex;gap:10px;flex-wrap:wrap}
    .priceRow{display:flex;align-items:baseline;justify-content:space-between;margin-top:10px;gap:10px}
    .price{font-weight:980;font-size:18px}
    .old{font-weight:980;font-size:12px;color:rgba(255,255,255,.55);text-decoration:line-through;margin-left:6px}

    .actions{display:flex;gap:10px;margin-top:10px}
    .actions .btn{flex:1;padding:11px 12px;border-radius:14px}

    /* Modal PDP */
    .modal{position:fixed;inset:0;display:none;z-index:90}
    .modal.is-open{display:block}
    .modal__overlay{position:absolute;inset:0;background:rgba(0,0,0,.68)}
    .modal__panel{position:relative;max-width:1100px;margin:4vh auto 0;background:linear-gradient(180deg, rgba(16,26,21,.98), rgba(8,12,10,.98));
      border:1px solid var(--line);border-radius:24px;box-shadow:var(--shadow);overflow:hidden}
    @media (max-width:1160px){.modal__panel{margin:3vh 14px 0}}
    .modal__close{position:absolute;top:10px;right:10px;border:1px solid var(--line);background:rgba(255,255,255,.04);color:var(--text);border-radius:12px;padding:8px 10px;cursor:pointer}

    .pdp{display:grid;grid-template-columns:1.05fr .95fr}
    @media (max-width:900px){.pdp{grid-template-columns:1fr}}

    .pdp__left{border-right:1px solid var(--line);background:rgba(0,0,0,.18)}
    @media (max-width:900px){.pdp__left{border-right:0;border-bottom:1px solid var(--line)}}

    .crumbs{padding:12px 14px;border-bottom:1px solid var(--line);color:var(--muted);font-size:12px;font-weight:850}
    .gallery{padding:14px;display:grid;gap:10px}
    .mainImg{border:1px solid rgba(255,255,255,.12);border-radius:20px;overflow:hidden;background:rgba(0,0,0,.18);display:grid;place-items:center}
    .mainImg svg{width:100%;height:360px}
    .thumbs{display:flex;gap:10px;flex-wrap:wrap}
    .thumb{width:92px;height:72px;border-radius:16px;border:1px solid var(--line);background:rgba(255,255,255,.03);display:grid;place-items:center;cursor:pointer;opacity:.9}
    .thumb:hover{border-color:rgba(255,255,255,.18)}
    .thumb.is-active{border-color:rgba(245,158,11,.40);background:rgba(245,158,11,.10)}
    .thumb svg{width:92%;height:92%}

    .pdp__right{padding:16px}
    .pdpTitle{margin:0;font-size:26px;font-weight:990;line-height:1.12}
    .subRow{margin-top:8px;color:var(--muted);font-size:13px;display:flex;gap:12px;flex-wrap:wrap}
    .hr{height:1px;background:var(--line);margin:14px 0}

    .sizeGrid{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .sizeBtn{border:1px solid var(--line);background:rgba(255,255,255,.03);color:var(--text);padding:10px 12px;border-radius:12px;font-weight:980;cursor:pointer;min-width:48px;text-align:center}
    .sizeBtn.is-active{border-color:rgba(34,197,94,.45);background:rgba(34,197,94,.14)}

    .yapeBox{border:1px solid var(--line);border-radius:20px;background:rgba(255,255,255,.03);padding:12px;display:flex;gap:14px;flex-wrap:wrap;align-items:center;justify-content:space-between}

    /* Footer */
    .footer{border-top:1px solid var(--line);padding:18px 0;margin-top:22px;background:rgba(255,255,255,.02)}
    .footer__inner{display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap}

    /* Fab */
    .fab{position:fixed;right:18px;bottom:18px;z-index:70;padding:12px 14px;border-radius:999px;
      background:linear-gradient(135deg, rgba(34,197,94,.95), rgba(34,197,94,.65));
      color:#07100b;font-weight:990;box-shadow:0 18px 55px rgba(34,197,94,.28)}

    .hideDesktop{display:none}
    @media (max-width:980px){.hideDesktop{display:inline-flex}}

    .empty{grid-column:1/-1;border:1px solid var(--line);border-radius:18px;background:rgba(255,255,255,.03);padding:14px}
  </style>
</head>
<body>

  <!-- Notice bar -->
  <div class="notice">
    <div class="container notice__inner">
      <div class="notice__item"><span class="dot"></span> Paga en cuotas (demo)</div>
      <div class="notice__item">EnvÃ­os desde S/ 399 (demo)</div>
      <div class="notice__item">Cambios sin costo (demo)</div>
      <div class="notice__item">Retiro en tienda (demo)</div>
    </div>
  </div>

  <!-- Header -->
  <header class="header">
    <div class="container header__row">
      <div class="brand">
        <div class="brand__logo">TOR</div>
        <div>
          <div class="brand__name">TOR HUB PGR</div>
          <div class="brand__sub">CatÃ¡logo estilo e-commerce â€¢ V3</div>
        </div>
      </div>

      <div class="search" role="search">
        <input id="q" type="search" placeholder="Â¿QuÃ© buscas? (ej: botÃ­n, hiking, waterproof)" autocomplete="off" />
        <span class="icon" aria-hidden="true">ðŸ”Ž</span>
      </div>

      <div class="icons">
        <button class="icoBtn" type="button" title="Favoritos (demo)"><span class="ico">â™¡</span></button>
        <button class="icoBtn" type="button" title="Cuenta (demo)"><span class="ico">ðŸ‘¤</span></button>
        <button class="icoBtn" type="button" title="Carrito (demo)"><span class="ico">ðŸ›’</span></button>
        <button class="icoBtn hideDesktop" type="button" id="openFilters">Filtrar</button>
      </div>
    </div>

    <div class="nav">
      <div class="container nav__inner">
        <div class="navlinks" id="navlinks">
          <a href="#" data-nav="SALE" class="active">SALE</a>
          <a href="#catalogo" data-brand="Caterpillar">CATERPILLAR</a>
          <a href="#catalogo" data-brand="Columbia">COLUMBIA</a>
          <a href="#catalogo" data-nav="NEW">NEW IN</a>
          <a href="#como-subir" data-nav="BLOG">BLOG</a>
        </div>
        <a class="pill" href="#catalogo">Ver catÃ¡logo</a>
      </div>
    </div>
  </header>

  <!-- Hero slider -->
  <section class="hero">
    <div class="container">
      <div class="heroCard">
        <div class="slide is-active" data-slide="0">
          <div class="slide__bg"></div>
          <div class="slide__content">
            <div>
              <div class="kicker"><span class="badge">FINAL SALE</span> Up to <b>50%</b> OFF</div>
              <h1 class="heroTitle">Calzado outdoor con look pro</h1>
              <p class="muted">V3 inspirado en e-commerce real: header completo, buscador central, filtros tipo tienda y ficha de producto con tallas.</p>
              <div class="ctaRow">
                <a class="btn btn--warn" href="#catalogo">COMPRAR</a>
                <button class="btn" type="button" id="goCaterpillar">Ver Caterpillar</button>
              </div>
            </div>
            <div class="heroArt" aria-hidden="true" id="heroArt"></div>
          </div>
        </div>

        <div class="slide" data-slide="1">
          <div class="slide__bg"></div>
          <div class="slide__content">
            <div>
              <div class="kicker"><span class="badge">NUEVOS</span> Columbia Hiking</div>
              <h1 class="heroTitle">Ligero, grip y ruta</h1>
              <p class="muted">Selecciona talla y se arma el WhatsApp automÃ¡ticamente con modelo + talla. Si no eliges talla, mensaje general.</p>
              <div class="ctaRow">
                <a class="btn btn--primary" href="#catalogo">Explorar</a>
                <button class="btn" type="button" id="goColumbia">Ver Columbia</button>
              </div>
            </div>
            <div class="heroArt" aria-hidden="true" id="heroArt2"></div>
          </div>
        </div>

        <div class="sliderDots" id="sliderDots" aria-label="Slider"></div>
      </div>
    </div>
  </section>

  <!-- Catalog -->
  <main class="container catalog" id="catalogo">
    <div class="catalogHead">
      <div>
        <h2>CatÃ¡logo</h2>
        <div class="muted">Ordena y filtra como en tienda online.</div>
      </div>
      <div class="headRight">
        <select id="sort" aria-label="Ordenar">
          <option value="relevance">Ordenar por relevancia</option>
          <option value="priceAsc">Precio: Menor a mayor</option>
          <option value="priceDesc">Precio: Mayor a menor</option>
          <option value="newest">Novedades primero</option>
          <option value="discount">Mayor descuento</option>
        </select>
        <button class="icoBtn" type="button" id="reset">Reset</button>
      </div>
    </div>

    <div class="layout">
      <!-- Desktop filters -->
      <aside class="filters" aria-label="Filtros">
        <h3>FILTRAR</h3>

        <div class="fgroup">
          <label>Marca</label>
          <div class="chips" id="brandChips"></div>
        </div>

        <div class="fgroup">
          <label>CategorÃ­a</label>
          <div class="chips" id="catChips"></div>
        </div>

        <div class="fgroup">
          <label>Talla</label>
          <div class="chips" id="sizeChips"></div>
        </div>

        <div class="fgroup">
          <label>Precio (S/)</label>
          <div class="rangeRow">
            <input id="pmin" type="number" inputmode="numeric" placeholder="Min" />
            <input id="pmax" type="number" inputmode="numeric" placeholder="Max" />
          </div>
          <div class="check">
            <input id="onlyDiscount" type="checkbox" />
            <span>Solo con descuento</span>
          </div>
        </div>

        <button class="btn btn--primary" type="button" id="applyPrice">Aplicar</button>
      </aside>

      <!-- Grid -->
      <section>
        <div class="grid" id="grid" aria-live="polite"></div>
      </section>
    </div>

    <section id="como-subir" style="margin-top:18px">
      <h3 style="margin:0 0 10px;font-weight:980">CÃ³mo subir (GitHub Pages)</h3>
      <div class="empty">
        <ol class="muted" style="margin:0;padding-left:18px">
          <li>Sube solo <b>index.html</b> a tu repo.</li>
          <li>Settings â†’ Pages â†’ Deploy from a branch â†’ <b>main</b> y carpeta <b>/(root)</b>.</li>
          <li>Abre tu URL de GitHub Pages.</li>
        </ol>
      </div>
    </section>
  </main>

  <!-- Mobile drawer filters -->
  <div class="drawer" id="drawer" aria-hidden="true">
    <div class="drawer__overlay" data-close="1"></div>
    <div class="drawer__panel">
      <div class="drawer__top">
        <h3>FILTRAR</h3>
        <button class="icoBtn" type="button" data-close="1">Cerrar</button>
      </div>
      <div class="hr"></div>

      <div class="fgroup">
        <label>Marca</label>
        <div class="chips" id="brandChipsM"></div>
      </div>
      <div class="fgroup">
        <label>CategorÃ­a</label>
        <div class="chips" id="catChipsM"></div>
      </div>
      <div class="fgroup">
        <label>Talla</label>
        <div class="chips" id="sizeChipsM"></div>
      </div>
      <div class="fgroup">
        <label>Precio (S/)</label>
        <div class="rangeRow">
          <input id="pminM" type="number" inputmode="numeric" placeholder="Min" />
          <input id="pmaxM" type="number" inputmode="numeric" placeholder="Max" />
        </div>
        <div class="check">
          <input id="onlyDiscountM" type="checkbox" />
          <span>Solo con descuento</span>
        </div>
      </div>
      <button class="btn btn--primary" type="button" id="applyPriceM">Aplicar</button>
    </div>
  </div>

  <!-- PDP modal -->
  <div class="modal" id="modal" aria-hidden="true" role="dialog" aria-label="Detalle de producto">
    <div class="modal__overlay" data-close="1"></div>
    <div class="modal__panel" role="document">
      <button class="modal__close" data-close="1" aria-label="Cerrar">âœ•</button>
      <div id="modalBody"></div>
    </div>
  </div>

  <a class="fab" id="fabWhatsapp" href="#" target="_blank" rel="noopener">WhatsApp</a>

  <footer class="footer">
    <div class="container footer__inner">
      <div class="muted">Â© TOR HUB PGR â€¢ V3 â€¢ Demo</div>
      <div class="muted">WhatsApp + talla opcional â€¢ Yape QR opcional</div>
    </div>
  </footer>

  <script>
    // === CONFIG (WHATSAPP + YAPE) ===
    const WHATSAPP = {
      Caterpillar: "51927137867", // PerÃº: 51 + 927137867
      Columbia: "51927137867",
      default: "51927137867"
    };

    // Pega aquÃ­ tu QR real (Data URL base64) si quieres mostrarlo.
    // Ejemplo: "data:image/png;base64,iVBORw0K..."
    const YAPE_QR_DATA_URL = "";
    const YAPE_OWNER = "Kim Dae";
    const YAPE_NOTE = "Pago por Yape (envÃ­a captura)";

    // === DATA (20 MODELOS DEMO) ===
    const PRODUCTS = [
      {id:"cat-001",brand:"Caterpillar",sku:"CAT-BOOT-001",name:"Boot TerraShield WP",category:"Boots",price:699,discount:20,isNew:true,rating:4.7,colors:["Honey","Black"],colorHex:"#d4a25b",sizes:[39,40,41,42,43,44,45],tags:["workwear","waterproof","outdoor"],features:["Cuero premium look","Waterproof (demo)","Suela grip tipo trail","Plantilla confort de alto retorno"]},
      {id:"cat-002",brand:"Caterpillar",sku:"CAT-BOOT-002",name:"RuggedForge 6\" Leather",category:"Boots",price:749,discount:0,isNew:false,rating:4.5,colors:["Brown"],colorHex:"#9c6a3a",sizes:[40,41,42,43,44],tags:["leather","rugged","daily"],features:["Perfil robusto","AmortiguaciÃ³n comfort (demo)","DiseÃ±o urbano-outdoor","Costuras reforzadas (demo)"]},
      {id:"cat-003",brand:"Caterpillar",sku:"CAT-HIKE-003",name:"HikeCore Traverse",category:"Hiking",price:639,discount:15,isNew:true,rating:4.6,colors:["Olive","Black"],colorHex:"#6b7d4a",sizes:[39,40,41,42,43,44],tags:["hiking","breathable","grip"],features:["Upper respirable (demo)","Grip multi-terreno","Soporte de tobillo medio","Ligero para caminatas largas"]},
      {id:"cat-004",brand:"Caterpillar",sku:"CAT-TRAIL-004",name:"TrailBurst GTX Style",category:"Trail",price:579,discount:10,isNew:false,rating:4.3,colors:["Graphite"],colorHex:"#7c848c",sizes:[40,41,42,43],tags:["trail","grip","light"],features:["DiseÃ±o trail agresivo","AmortiguaciÃ³n rÃ¡pida (demo)","Suela con tacos","Ideal para ciudad + ruta"]},
      {id:"cat-005",brand:"Caterpillar",sku:"CAT-URB-005",name:"UrbanSteel Low",category:"Urban",price:529,discount:0,isNew:true,rating:4.4,colors:["Black","Sand"],colorHex:"#8d7b62",sizes:[39,40,41,42,43],tags:["urban","minimal","daily"],features:["Look minimal robusto","Confort para uso diario","Materiales resistentes (demo)","FÃ¡cil de combinar"]},
      {id:"cat-006",brand:"Caterpillar",sku:"CAT-BOOT-006",name:"IronPath 8\" Pro",category:"Boots",price:799,discount:25,isNew:false,rating:4.8,colors:["Honey"],colorHex:"#c98b3b",sizes:[41,42,43,44,45],tags:["workwear","heavy","boot"],features:["CaÃ±a alta soporte","DiseÃ±o heavy-duty (demo)","Suela anti-fatiga (demo)","ConstrucciÃ³n robusta"]},
      {id:"cat-007",brand:"Caterpillar",sku:"CAT-HIKE-007",name:"SummitLine Mid",category:"Hiking",price:669,discount:0,isNew:false,rating:4.2,colors:["Brown","Olive"],colorHex:"#7c5a3a",sizes:[39,40,41,42,43,44],tags:["hiking","mid","support"],features:["Soporte medio","Suela de tracciÃ³n","Forro suave (demo)","Uso outdoor ligero"]},
      {id:"cat-008",brand:"Caterpillar",sku:"CAT-TRAIL-008",name:"RapidTread Runner",category:"Trail",price:499,discount:5,isNew:true,rating:4.1,colors:["Black"],colorHex:"#9aa0a6",sizes:[39,40,41,42,43],tags:["trail","runner","city"],features:["Perfil runner","Grip trail","Ligero (demo)","TransiciÃ³n ciudad-ruta"]},
      {id:"cat-009",brand:"Caterpillar",sku:"CAT-URB-009",name:"ConcreteCraft Sneaker",category:"Urban",price:459,discount:12,isNew:false,rating:4.0,colors:["Sand","Black"],colorHex:"#b09a7a",sizes:[40,41,42,43,44],tags:["sneaker","urban","daily"],features:["Sneaker robusto","Plantilla cÃ³moda","Suela durable (demo)","Estilo street-outdoor"]},
      {id:"cat-010",brand:"Caterpillar",sku:"CAT-SAND-010",name:"VentTrail Sandal",category:"Sandals",price:329,discount:0,isNew:true,rating:4.3,colors:["Black","Olive"],colorHex:"#6b7280",sizes:[39,40,41,42,43,44],tags:["sandals","summer","outdoor"],features:["Sandalia outdoor (demo)","Correas ajustables","Suela grip","Uso verano / viajes"]},

      {id:"col-001",brand:"Columbia",sku:"COL-HIKE-001",name:"PeakVista Waterproof",category:"Hiking",price:589,discount:18,isNew:true,rating:4.6,colors:["Grey","Blue"],colorHex:"#8ab4f8",sizes:[39,40,41,42,43,44],tags:["waterproof","hiking","light"],features:["Waterproof (demo)","Upper respirable (demo)","TracciÃ³n multi-terreno","Ideal trekking ligero"]},
      {id:"col-002",brand:"Columbia",sku:"COL-TRAIL-002",name:"TrailNova Grip",category:"Trail",price:519,discount:0,isNew:false,rating:4.4,colors:["Black","Grey"],colorHex:"#94a3b8",sizes:[40,41,42,43],tags:["trail","grip","runner"],features:["Suela de tacos","AmortiguaciÃ³n rÃ¡pida (demo)","Ligero para trail","Uso mixto"]},
      {id:"col-003",brand:"Columbia",sku:"COL-URB-003",name:"CityRidge Sneaker",category:"Urban",price:449,discount:10,isNew:true,rating:4.2,colors:["White","Grey"],colorHex:"#cbd5e1",sizes:[39,40,41,42,43],tags:["urban","daily","minimal"],features:["Estilo urbano","Confort diario","Material resistente (demo)","Look limpio premium"]},
      {id:"col-004",brand:"Columbia",sku:"COL-BOOT-004",name:"StormHaven Mid",category:"Boots",price:679,discount:22,isNew:false,rating:4.7,colors:["Brown","Black"],colorHex:"#8b5a2b",sizes:[41,42,43,44,45],tags:["boots","waterproof","outdoor"],features:["Mid boot soporte","Waterproof (demo)","Grip tipo hiking","Comodidad prolongada"]},
      {id:"col-005",brand:"Columbia",sku:"COL-HIKE-005",name:"AlpineStep Vent",category:"Hiking",price:539,discount:0,isNew:false,rating:4.1,colors:["Olive"],colorHex:"#7a8f58",sizes:[39,40,41,42,43,44],tags:["hiking","vent","comfort"],features:["VentilaciÃ³n (demo)","Soporte medio","Suela grip","Trekking de dÃ­a completo"]},
      {id:"col-006",brand:"Columbia",sku:"COL-TRAIL-006",name:"TerraFlow Runner",category:"Trail",price:489,discount:8,isNew:true,rating:4.3,colors:["Blue","Black"],colorHex:"#60a5fa",sizes:[39,40,41,42,43],tags:["trail","runner","light"],features:["Runner trail","Ligero (demo)","TracciÃ³n agresiva","Uso ciudad + ruta"]},
      {id:"col-007",brand:"Columbia",sku:"COL-URB-007",name:"MetroPeak Low",category:"Urban",price:469,discount:0,isNew:false,rating:4.0,colors:["Grey"],colorHex:"#9ca3af",sizes:[40,41,42,43,44],tags:["urban","street","daily"],features:["Street clean","Plantilla comfort","Suela durable (demo)","Uso diario"]},
      {id:"col-008",brand:"Columbia",sku:"COL-BOOT-008",name:"SummitGuard 6\"",category:"Boots",price:699,discount:15,isNew:true,rating:4.5,colors:["Black"],colorHex:"#a3a3a3",sizes:[41,42,43,44],tags:["boots","outdoor","grip"],features:["Boot 6 pulgadas","Grip multi-terreno","Comodidad prolongada","Perfil outdoor pro"]},
      {id:"col-009",brand:"Columbia",sku:"COL-SAND-009",name:"CoastLine Sandal",category:"Sandals",price:299,discount:0,isNew:true,rating:4.2,colors:["Black","Blue"],colorHex:"#64748b",sizes:[39,40,41,42,43,44],tags:["sandals","summer","travel"],features:["Sandalia travel","Ajuste rÃ¡pido","Suela grip","Ideal verano"]},
      {id:"col-010",brand:"Columbia",sku:"COL-HIKE-010",name:"RidgeWalker Pro",category:"Hiking",price:599,discount:12,isNew:false,rating:4.4,colors:["Brown","Grey"],colorHex:"#a78b6d",sizes:[40,41,42,43,44,45],tags:["hiking","support","durable"],features:["Soporte estable","TracciÃ³n fuerte","Material durable (demo)","Trekking exigente"]}
    ];

    // === Helpers ===
    const $ = (sel) => document.querySelector(sel);
    const $$ = (sel) => Array.from(document.querySelectorAll(sel));
    const money = (pen) => `S/ ${Number(pen).toFixed(2)}`;
    const finalPrice = (p) => (!p.discount || p.discount<=0) ? p.price : Math.round((p.price*(1-p.discount/100))*100)/100;

    function svgShoeCard({ brand, name, color }){
      const accent = brand === "Caterpillar" ? "#f59e0b" : "#22c55e";
      const base = color || "#cbd5e1";
      return `
      <svg viewBox="0 0 900 520" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="${name}">
        <defs>
          <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
            <stop offset="0" stop-color="${accent}" stop-opacity=".32"/>
            <stop offset="1" stop-color="#000" stop-opacity=".0"/>
          </linearGradient>
          <filter id="s" x="-20%" y="-20%" width="140%" height="140%">
            <feDropShadow dx="0" dy="16" stdDeviation="18" flood-color="#000" flood-opacity=".35"/>
          </filter>
        </defs>
        <rect x="0" y="0" width="900" height="520" rx="28" fill="url(#g)"/>
        <text x="40" y="70" fill="rgba(255,255,255,.85)" font-size="34" font-weight="900" letter-spacing="2">${brand}</text>
        <path filter="url(#s)"
          d="M140 318 C200 250, 250 220, 340 220 C420 220, 470 258, 530 268 C590 278, 650 260, 720 260 C760 260, 790 284, 790 318 C790 350, 770 372, 740 382 C680 402, 600 416, 470 416 C360 416, 270 410, 210 392 C160 376, 120 352, 140 318 Z"
          fill="${base}" stroke="rgba(255,255,255,.18)" stroke-width="6" />
        <path
          d="M170 356 C250 392, 360 400, 470 400 C600 400, 680 388, 740 370 C760 364, 776 354, 786 340 L786 360 C772 386, 748 400, 720 410 C660 432, 590 446, 470 448 C350 448, 260 440, 200 424 C168 414, 138 396, 122 372 L122 350 C132 360, 150 370, 170 356 Z"
          fill="rgba(15,23,19,.85)" />
        <circle cx="330" cy="290" r="12" fill="rgba(255,255,255,.25)"/>
        <circle cx="370" cy="286" r="12" fill="rgba(255,255,255,.22)"/>
        <circle cx="410" cy="286" r="12" fill="rgba(255,255,255,.20)"/>
        <text x="40" y="480" fill="rgba(255,255,255,.7)" font-size="22" font-weight="800">${name}</text>
      </svg>`;
    }

    function buildWhatsappLink(product, sizeChosen){
      const phone = WHATSAPP[product.brand] || WHATSAPP.default;
      const lines = [
        "Hola, quiero informaciÃ³n / comprar:",
        `${product.brand} - ${product.name}`,
        `Precio: ${money(finalPrice(product))}`,
        `CÃ³digo: ${product.sku}`
      ];
      if (sizeChosen) lines.splice(2, 0, `Talla: ${sizeChosen}`);
      const msg = lines.join("
");
      return `https://wa.me/${phone}?text=${encodeURIComponent(msg)}`;
    }

    // === State ===
    const state = {
      q: "",
      brand: "All",
      category: "All",
      size: "All",
      sort: "relevance",
      pmin: "",
      pmax: "",
      onlyDiscount: false
    };

    const BRANDS = ["All","Caterpillar","Columbia"];
    const CATS = ["All","Boots","Hiking","Trail","Urban","Sandals"];
    const SIZES = ["All",39,40,41,42,43,44,45];

    function matchFilters(p){
      const q = state.q.trim().toLowerCase();
      const qOk = !q || (
        p.name.toLowerCase().includes(q) ||
        p.brand.toLowerCase().includes(q) ||
        p.category.toLowerCase().includes(q) ||
        (p.tags||[]).join(" ").toLowerCase().includes(q)
      );
      const brandOk = state.brand === "All" || p.brand === state.brand;
      const catOk = state.category === "All" || p.category === state.category;
      const sizeOk = state.size === "All" || (p.sizes||[]).includes(Number(state.size));

      const fp = finalPrice(p);
      const pminOk = state.pmin === "" || fp >= Number(state.pmin);
      const pmaxOk = state.pmax === "" || fp <= Number(state.pmax);
      const discOk = !state.onlyDiscount || (p.discount||0) > 0;

      return qOk && brandOk && catOk && sizeOk && pminOk && pmaxOk && discOk;
    }

    function sortProducts(list){
      const copy = [...list];
      if(state.sort === "priceAsc") copy.sort((a,b)=>finalPrice(a)-finalPrice(b));
      if(state.sort === "priceDesc") copy.sort((a,b)=>finalPrice(b)-finalPrice(a));
      if(state.sort === "newest") copy.sort((a,b)=>(b.isNew?1:0)-(a.isNew?1:0));
      if(state.sort === "discount") copy.sort((a,b)=>(b.discount||0)-(a.discount||0));
      return copy;
    }

    function cardHTML(p){
      const hasSale = (p.discount||0) > 0;
      const old = hasSale ? `<span class="old">${money(p.price)}</span>` : "";
      return `
        <article class="card" data-open="${p.id}">
          <div class="card__img">${svgShoeCard({brand:p.brand,name:p.name,color:p.colorHex})}</div>
          <div class="card__body">
            <div class="badges">
              <span class="badge2">${p.brand}</span>
              <span class="badge2">${p.category}</span>
              ${p.isNew ? `<span class="badge2 badge2--new">NEW</span>` : ``}
              ${hasSale ? `<span class="badge2 badge2--sale">-${p.discount}%</span>` : ``}
            </div>
            <h3 class="title">${p.name}</h3>
            <div class="meta">
              <span>SKU: <b>${p.sku}</b></span>
              <span>Rating: <b>${p.rating.toFixed(1)}</b> â˜…</span>
            </div>
            <div class="priceRow">
              <div class="price">${money(finalPrice(p))} ${old}</div>
              <div class="muted" style="font-size:12px">Tallas: ${(p.sizes||[]).slice(0,4).join(" ")}â€¦</div>
            </div>
            <div class="actions">
              <button class="btn" type="button" data-open="${p.id}">Quick View</button>
              <a class="btn btn--primary" href="${buildWhatsappLink(p)}" target="_blank" rel="noopener">Pedir</a>
            </div>
          </div>
        </article>`;
    }

    function renderChips(){
      const make = (vals, current, onClick) => vals.map(v=>{
        const label = String(v);
        const active = String(current) === String(v);
        return `<button class="chip ${active?"is-active":""}" type="button" data-val="${label}">${label==="All"?"Todas":label}</button>`;
      }).join("");

      $("#brandChips").innerHTML = make(BRANDS, state.brand);
      $("#catChips").innerHTML = make(CATS, state.category);
      $("#sizeChips").innerHTML = make(SIZES, state.size);

      $("#brandChipsM").innerHTML = make(BRANDS, state.brand);
      $("#catChipsM").innerHTML = make(CATS, state.category);
      $("#sizeChipsM").innerHTML = make(SIZES, state.size);

      // bind (desktop + mobile)
      const bind = (rootSel, key) => {
        $$(rootSel+" .chip").forEach(btn=>{
          btn.addEventListener("click",()=>{
            const v = btn.dataset.val;
            state[key] = (key === "size" && v !== "All") ? Number(v) : v;
            render();
          });
        });
      };
      bind("#brandChips","brand");
      bind("#catChips","category");
      bind("#sizeChips","size");
      bind("#brandChipsM","brand");
      bind("#catChipsM","category");
      bind("#sizeChipsM","size");
    }

    function renderGrid(){
      const list = sortProducts(PRODUCTS.filter(matchFilters));
      $("#grid").innerHTML = list.length
        ? list.map(cardHTML).join("")
        : `<div class="empty"><b>No hay resultados.</b><div class="muted">Prueba cambiar filtros o buscar con otra palabra.</div></div>`;

      // bind open
      $$('[data-open]').forEach(el=>{
        el.addEventListener('click',(e)=>{
          if(e.target && e.target.tagName === 'A') return;
          const id = el.getAttribute('data-open');
          openModal(id);
        });
      });
    }

    function renderFab(){
      const phone = WHATSAPP[state.brand] || WHATSAPP.default;
      $("#fabWhatsapp").href = `https://wa.me/${phone}?text=${encodeURIComponent("Hola, quiero informaciÃ³n del catÃ¡logo de calzado.")}`;
    }

    function render(){
      // sync inputs
      $("#sort").value = state.sort;

      // desktop price inputs
      $("#pmin").value = state.pmin;
      $("#pmax").value = state.pmax;
      $("#onlyDiscount").checked = state.onlyDiscount;

      // mobile price inputs
      $("#pminM").value = state.pmin;
      $("#pmaxM").value = state.pmax;
      $("#onlyDiscountM").checked = state.onlyDiscount;

      renderChips();
      renderGrid();
      renderFab();
    }

    // === PDP modal ===
    function openModal(productId){
      const p = PRODUCTS.find(x=>x.id===productId);
      if(!p) return;

      const hasSale = (p.discount||0) > 0;
      const yapeQR = YAPE_QR_DATA_URL
        ? `<img src="${YAPE_QR_DATA_URL}" alt="QR Yape" style="width:220px;height:220px;border-radius:18px;border:1px solid var(--line);background:rgba(255,255,255,.03);object-fit:cover"/>`
        : `<div style="width:220px;height:220px;border-radius:18px;border:1px dashed rgba(255,255,255,.22);display:grid;place-items:center;text-align:center;padding:14px" class="muted">
             <div>
               <div style="font-weight:980;color:rgba(255,255,255,.85)">QR Yape (opcional)</div>
               <div style="font-size:12px;margin-top:6px">Pega tu QR en <b>YAPE_QR_DATA_URL</b> (base64).</div>
             </div>
           </div>`;

      const thumbs = [
        {k:"a", c:p.colorHex},
        {k:"b", c:(p.brand==="Caterpillar"?"#8d7b62":"#94a3b8")},
        {k:"c", c:(p.brand==="Caterpillar"?"#6b7d4a":"#60a5fa")}
      ];

      $("#modalBody").innerHTML = `
        <div class="pdp">
          <div class="pdp__left">
            <div class="crumbs">Inicio  â€º  ${p.brand}  â€º  ${p.category}  â€º  ${p.name}</div>
            <div class="gallery">
              <div class="mainImg" id="mainImg">${svgShoeCard({brand:p.brand,name:p.name,color:p.colorHex})}</div>
              <div class="thumbs" id="thumbs">
                ${thumbs.map((t,i)=>`
                  <div class="thumb ${i===0?"is-active":""}" data-color="${t.c}">
                    ${svgShoeCard({brand:p.brand,name:p.name,color:t.c})}
                  </div>`).join("")}
              </div>
            </div>
          </div>

          <div class="pdp__right">
            <div class="badges">
              <span class="badge2">${p.brand}</span>
              <span class="badge2">${p.category}</span>
              ${p.isNew ? `<span class="badge2 badge2--new">NEW</span>` : ``}
              ${hasSale ? `<span class="badge2 badge2--sale">-${p.discount}%</span>` : ``}
            </div>

            <h3 class="pdpTitle">${p.name}</h3>
            <div class="subRow">
              <span>SKU: <b>${p.sku}</b></span>
              <span>Rating: <b>${p.rating.toFixed(1)}</b> â˜…</span>
              <span>Colores: <b>${(p.colors||[]).join(", ")}</b></span>
            </div>

            <div class="hr"></div>

            <div style="display:flex;gap:12px;align-items:baseline;flex-wrap:wrap">
              <div class="price" style="font-size:30px">${money(finalPrice(p))}
                ${hasSale ? `<span class="old" style="font-size:13px">${money(p.price)}</span>` : ``}
              </div>
              <div class="muted" style="font-weight:900">Hasta 3 cuotas (demo)</div>
            </div>

            <div class="hr"></div>

            <div class="muted" style="font-size:12px;font-weight:900">Elige talla (opcional)</div>
            <div class="sizeGrid" id="sizeGrid">
              ${(p.sizes||[]).map(sz=>`<button class="sizeBtn" type="button" data-size="${sz}">${sz}</button>`).join("")}
            </div>

            <div class="hr"></div>

            <div class="empty" style="padding:12px">
              <div style="font-weight:980">CaracterÃ­sticas</div>
              <ul class="muted" style="margin:10px 0 0;padding-left:18px">
                ${(p.features||[]).map(f=>`<li>${f}</li>`).join("")}
              </ul>
            </div>

            <div style="display:flex;gap:10px;margin-top:12px;flex-wrap:wrap">
              <a class="btn btn--primary" id="modalBuy" href="${buildWhatsappLink(p)}" target="_blank" rel="noopener" style="flex:1;min-width:220px">Comprar Ahora</a>
              <button class="btn" type="button" data-close="1">Cerrar</button>
            </div>

            <div class="hr"></div>

            <div class="yapeBox">
              <div>
                <div style="font-weight:980">Pago por Yape (opcional)</div>
                <div class="muted" style="font-size:12px;margin-top:6px">${YAPE_NOTE}</div>
                <div class="muted" style="font-size:12px;margin-top:6px">Titular: <b>${YAPE_OWNER}</b></div>
              </div>
              ${yapeQR}
            </div>

            <div class="muted" style="font-size:12px;margin-top:10px">Si no eliges talla, el mensaje va general. Si eliges talla, se agrega al WhatsApp automÃ¡ticamente.</div>
          </div>
        </div>
      `;

      // Bind thumbs
      const main = $("#mainImg");
      $$("#thumbs .thumb").forEach(th=>{
        th.addEventListener("click",()=>{
          $$("#thumbs .thumb").forEach(t=>t.classList.remove("is-active"));
          th.classList.add("is-active");
          const c = th.dataset.color;
          main.innerHTML = svgShoeCard({brand:p.brand,name:p.name,color:c});
        });
      });

      // Bind size -> whatsapp
      let chosenSize = null;
      $$("#sizeGrid .sizeBtn").forEach(btn=>{
        btn.addEventListener("click",()=>{
          $$("#sizeGrid .sizeBtn").forEach(b=>b.classList.remove("is-active"));
          btn.classList.add("is-active");
          chosenSize = btn.dataset.size;
          $("#modalBuy").href = buildWhatsappLink(p, chosenSize);
        });
      });

      const modal = $("#modal");
      modal.classList.add("is-open");
      modal.setAttribute("aria-hidden","false");
    }

    function closeModal(){
      const modal = $("#modal");
      modal.classList.remove("is-open");
      modal.setAttribute("aria-hidden","true");
    }

    // === Slider ===
    function setupSlider(){
      const slides = $$(".slide");
      const dots = $("#sliderDots");
      let idx = 0;

      dots.innerHTML = slides.map((_,i)=>`<button class="dotBtn ${i===0?"is-active":""}" type="button" data-i="${i}" aria-label="slide ${i+1}"></button>`).join("");

      const set = (i) => {
        idx = i;
        slides.forEach((s,k)=>s.classList.toggle("is-active", k===idx));
        $$(".dotBtn").forEach((d,k)=>d.classList.toggle("is-active", k===idx));
      };

      $$(".dotBtn").forEach(btn=>btn.addEventListener("click",()=>set(Number(btn.dataset.i))));

      // auto
      setInterval(()=> set((idx+1)%slides.length), 5200);

      // hero art
      const p1 = PRODUCTS.find(p=>p.brand==="Caterpillar") || PRODUCTS[0];
      const p2 = PRODUCTS.find(p=>p.brand==="Columbia") || PRODUCTS[10];
      $("#heroArt").innerHTML = svgShoeCard({brand:p1.brand,name:p1.name,color:p1.colorHex});
      $("#heroArt2").innerHTML = svgShoeCard({brand:p2.brand,name:p2.name,color:p2.colorHex});
    }

    // === Drawer ===
    function openDrawer(){
      const d = $("#drawer");
      d.classList.add("is-open");
      d.setAttribute("aria-hidden","false");
    }
    function closeDrawer(){
      const d = $("#drawer");
      d.classList.remove("is-open");
      d.setAttribute("aria-hidden","true");
    }

    // === Apply price (desktop + mobile) ===
    function applyPriceFromDesktop(){
      state.pmin = $("#pmin").value.trim();
      state.pmax = $("#pmax").value.trim();
      state.onlyDiscount = $("#onlyDiscount").checked;
      render();
    }
    function applyPriceFromMobile(){
      state.pmin = $("#pminM").value.trim();
      state.pmax = $("#pmaxM").value.trim();
      state.onlyDiscount = $("#onlyDiscountM").checked;
      closeDrawer();
      render();
    }

    // === Tests (console) ===
    function assert(cond, msg){ if(!cond) throw new Error(msg || "assert failed"); }
    function runTests(){
      const p = PRODUCTS[0];
      const u1 = buildWhatsappLink(p);
      assert(u1.includes("wa.me/51927137867"), "WhatsApp phone mismatch");
      assert(u1.includes(encodeURIComponent(p.name)), "Missing product name in url");
      const u2 = buildWhatsappLink(p, "41");
      assert(u2.includes(encodeURIComponent("Talla: 41")), "Missing size in url");
      return true;
    }
    try{ runTests(); console.log("[TOR HUB V3] tests: OK"); }catch(e){ console.warn("[TOR HUB V3] tests: FAIL", e); }

    // === Wire UI ===
    setupSlider();

    $("#q").addEventListener("input", (e)=>{ state.q = e.target.value; render(); });
    $("#sort").addEventListener("change", (e)=>{ state.sort = e.target.value; render(); });

    $("#applyPrice").addEventListener("click", applyPriceFromDesktop);
    $("#applyPriceM").addEventListener("click", applyPriceFromMobile);

    $("#openFilters").addEventListener("click", openDrawer);
    $("#drawer").addEventListener("click", (e)=>{ if(e.target && e.target.dataset && e.target.dataset.close) closeDrawer(); });

    $("#modal").addEventListener("click", (e)=>{ if(e.target && e.target.dataset && e.target.dataset.close) closeModal(); });
    document.addEventListener("keydown", (e)=>{ if(e.key === "Escape") { closeModal(); closeDrawer(); } });

    $("#reset").addEventListener("click", ()=>{
      state.q=""; state.brand="All"; state.category="All"; state.size="All"; state.sort="relevance"; state.pmin=""; state.pmax=""; state.onlyDiscount=false;
      $("#q").value="";
      render();
    });

    // nav brand shortcuts
    $$("#navlinks [data-brand]").forEach(a=>{
      a.addEventListener("click", (e)=>{
        e.preventDefault();
        state.brand = a.dataset.brand;
        document.getElementById('catalogo').scrollIntoView({behavior:'smooth'});
        render();
      });
    });

    $("#goCaterpillar").addEventListener("click", ()=>{ state.brand = "Caterpillar"; document.getElementById('catalogo').scrollIntoView({behavior:'smooth'}); render(); });
    $("#goColumbia").addEventListener("click", ()=>{ state.brand = "Columbia"; document.getElementById('catalogo').scrollIntoView({behavior:'smooth'}); render(); });

    // initial render
    render();
  </script>
</body>
</html>
